<?php
/** @var \Magento\Framework\View\Element\Template $block */

use BigConnect\HyvaStarter\ViewModel\HomepageCategories;
use Hyva\Theme\ViewModel\HeroiconsOutline;

$categories = $viewModels->require(HomepageCategories::class);
$heroicons  = $viewModels->require(HeroiconsOutline::class);

if (!$categories->isEnabled()) {
    return;
}

$items = $categories->getItems();
if (!$items) {
    return;
}
?>

<div class="relative left-1/2 right-1/2 -ml-[50vw] -mr-[50vw] w-screen">
    <section class="py-20 bg-secondary-lighter">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-text mb-4">
                    <?= $block->escapeHtml($categories->getTitle()) ?>
                </h2>
                <p class="text-xl text-muted max-w-2xl mx-auto">
                    <?= $block->escapeHtml($categories->getSubtitle()) ?>
                </p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <?php foreach ($items as $item): ?>
                    <div class="group bg-white border border-border rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300 flex flex-col h-full">
                        <div class="bg-white h-56 overflow-hidden">
                            <?php if (!empty($item['img'])): ?>
                                <img
                                    src="<?= $block->escapeUrl($item['img']) ?>"
                                    alt="<?= $block->escapeHtmlAttr($item['name']) ?>"
                                    loading="lazy"
                                    decoding="async"
                                    class="w-full h-full object-contain p-8 group-hover:scale-105 transition-transform duration-300"
                                />
                            <?php endif; ?>
                        </div>

                        <!-- content -->
                        <div class="p-6 flex flex-col flex-1">
                            <h3 class="font-bold text-text mb-3 text-[18px] leading-tight">
                                <?= $block->escapeHtml($item['name']) ?>
                            </h3>

                            <!-- this pushes the CTA to the bottom -->
                            <div class="flex-1">
                                <?php if (!empty($item['desc'])): ?>
                                    <p class="text-sm text-muted leading-relaxed">
                                        <?= $block->escapeHtml($item['desc']) ?>
                                    </p>
                                <?php endif; ?>
                            </div>

                            <a
                                href="<?= $block->escapeUrl($item['url']) ?>"
                                class="mt-6 w-full py-3 text-white rounded-lg font-medium transition-all inline-flex items-center justify-center gap-2 bg-primary hover:bg-primary-darker"
                            >
                                <?= $block->escapeHtml(__('Do kategÃ³rie')) ?>
                                <?= /* @noEscape */ $heroicons->arrowNarrowRightHtml('w-4 h-4') ?>
                            </a>
                        </div>
                    </div>
                <?php endforeach; ?>
            </div>
        </div>
    </section>
</div>
