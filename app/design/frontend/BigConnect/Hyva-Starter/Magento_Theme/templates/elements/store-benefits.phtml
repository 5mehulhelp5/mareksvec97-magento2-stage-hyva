<?php
declare(strict_types=1);

/** @var \Hyva\Theme\Model\ViewModelRegistry $viewModels */
/** @var \Magento\Framework\View\Element\Template $block */

use Hyva\Theme\ViewModel\HeroiconsOutline;

$heroIcons = $viewModels->require(HeroiconsOutline::class);
$benefits = $viewModels->require(\BigConnect\HyvaStarter\ViewModel\StoreBenefitsConfig::class);
$items = $benefits->getItems();

if (!$items) {
    return;
}
?>

<!-- FULL-WIDTH breakout (funguje aj keÄ parent je .container / max-width) -->
<div class="relative left-1/2 right-1/2 -ml-[50vw] -mr-[50vw] w-screen">
    <div class="py-12 border-y bg-primary border-primary-darker">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <?php foreach ($items as $item): ?>
                    <?php
                    $method = $item['icon_method'] ?? 'badgeCheckHtml';
                    if (!method_exists($heroIcons, $method)) {
                        $method = 'badgeCheckHtml';
                    }
                    ?>
                    <div class="flex flex-col items-center text-center gap-3">
                        <div class="w-16 h-16 rounded-full flex items-center justify-center bg-white">
                            <?php if (!empty($item['icon_custom_url'])): ?>
                                <img
                                    src="<?= $block->escapeUrl($item['icon_custom_url']) ?>"
                                    alt="<?= $block->escapeHtmlAttr($item['title'] ?: __('Store benefit icon')) ?>"
                                    class="w-8 h-8 object-contain"
                                    loading="lazy"
                                />
                            <?php else: ?>
                                <?= /* @noEscape */ $heroIcons->{$method}('w-8 h-8 text-primary') ?>
                            <?php endif; ?>
                        </div>

                        <?php if (trim((string)$item['title']) !== ''): ?>
                            <h3 class="text-[18px] font-bold text-white leading-tight">
                                <?= $block->escapeHtml($item['title']) ?>
                            </h3>
                        <?php endif; ?>

                        <?php if (trim((string)$item['text']) !== ''): ?>
                            <p class="text-sm text-white leading-relaxed opacity-90">
                                <?= $block->escapeHtml($item['text']) ?>
                            </p>
                        <?php endif; ?>
                    </div>
                <?php endforeach; ?>
            </div>
        </div>
    </div>
</div>
