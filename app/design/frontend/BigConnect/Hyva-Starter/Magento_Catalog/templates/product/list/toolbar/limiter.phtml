<?php
declare(strict_types=1);

use Magento\Catalog\Block\Product\ProductList\Toolbar;

/** @var Toolbar $block */

$limits = (array) $block->getAvailableLimit();
$current = (int) $block->getLimit();
$default = (int) ($block->getDefaultPerPageValue() ?: $current);
?>

<?php if ($limits): ?>

  <!-- MOBILE: chips -->
  <div class="sm:hidden">
    <div class="flex flex-wrap gap-2">
      <?php foreach ($limits as $key => $label): ?>
        <?php $val = (int) $key; $active = $val === $current; ?>
        <button type="button"
                @click="changeUrl(options.limit, <?= (int)$val ?>, <?= (int)$default ?>)"
                class="min-h-[44px] px-4 rounded-full text-[14px] font-semibold transition-colors
                       <?= $active ? 'bg-gray-200 text-slate-900' : 'bg-gray-100 hover:bg-gray-200 text-slate-800' ?>">
          <?= (int)$label ?>
        </button>
      <?php endforeach; ?>
    </div>
    <div class="mt-2 text-xs text-slate-500">
      <?= $block->escapeHtml(__('Počet produktov na stránku')) ?>
    </div>
  </div>

  <!-- DESKTOP: pill select -->
  <div class="hidden sm:block">
    <div class="relative inline-flex">
      <select class="appearance-none min-h-[48px] rounded-full bg-gray-100 hover:bg-gray-200 transition-colors
                     border border-transparent focus:border-slate-300 focus:ring-2 focus:ring-slate-200
                     pl-4 pr-12 text-[15px] font-semibold text-slate-800"
              @change="changeUrl(options.limit, $event.target.value, <?= (int)$default ?>)"
              aria-label="<?= $block->escapeHtmlAttr(__('Zobraziť')) ?>">
        <?php foreach ($limits as $key => $label): ?>
          <?php $val = (int) $key; ?>
          <option value="<?= $val ?>" <?= $val === $current ? 'selected' : '' ?>>
            <?= $block->escapeHtml($label) ?>
          </option>
        <?php endforeach; ?>
      </select>

      <span class="pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-slate-600">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
             stroke-width="2" stroke="currentColor" class="h-5 w-5" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
        </svg>
      </span>
    </div>
  </div>

<?php endif; ?>
